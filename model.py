
import numpy as np
import pandas as pd
from create_vector import *
import cv2  
import csv 
#get the variables for the model from the videos of the file
data=pd.read_excel('Frames.xlsx') 
data=pd.DataFrame(data)

x=[]
for i in range(len(data)):
    d=data.iloc[i,:]
    if d.values[1]==30:
        frames_vector=np.arange(d.start,d.end,2)
    else:
        frames_vector=np.arange(d.start,d.end,1)
    x.append(test(d.values[0],frames_vector))

print(x)

#create a file with the variables 
y=data['KSS']
fields = ['LOWEAR_FRAMES','LOWEAR_COUNTER', 'YAWN_FRAMES','LIP_DISTANCE_COUNTER']   
x=pd.DataFrame(x, columns=fields)
x["KSS"]=data['KSS']   
print(x)
x.to_csv("Myfile.csv")

"""
 [[0.14761904761904762, 0.6817336264587814, 0.0, 0.23492264063534224], [0.13526570048309178, 0.6724846069342986, 0.0, 0.3106749107843831], [0.26968973747016706, 0.5459771591274762, 0.0, 0.30711778781782106], [0.19047619047619047, 0.6094923271982369, 0.0, 0.18795415470957208], [0.665871121718377, 0.40781601980879195, 0.0, 0.33813181260254505], [0.19285714285714287, 0.6100592317477351, 0.3619047619047619, 0.13692612058300124], [0.1971153846153846, 0.626089160931641, 0.0, 0.3336798206990457], [0.20763723150357996, 0.6033821471686234, 0.5107398568019093, 0.38211849102225603], [0.07673860911270983, 0.6746163586867086, 0.0, 0.416880919202798], [0.11217183770883055, 0.6873226788679277, 0.0, 0.523968201863651], [0.03571428571428571, 0.7159898606353337, 0.0, 0.4974105805008029], [0.06666666666666667, 0.6580126066411164, 0.0, 0.4101031258552353], [0.7732696897374701, 0.4811787966843521, 0.42720763723150357, 0.22637050693297747], [0.43444730077120824, 0.5150208206559137, 0.0, 0.7820804556278889], [0.5775656324582339, 0.4379068021575012, 0.5250596658711217, 0.0926085387958917], [0.14761904761904762, 0.65349588591433, 0.0, 0.48678678563002], [0.0380952380952381, 0.7576976313789157, 0.0, 0.35970693449213265], [0.12649164677804295, 0.6757005565975257, 0.0, 0.27006030591497415], [0.1261904761904762, 0.6491397305182366, 0.0, 0.21986983916143454], [0.2649164677804296, 0.5978743217063447, 0.3627684964200477, 0.09771909750818307], [0.18095238095238095, 0.6494672896744422, 0.0, 0.3358299086375693], [0.5493975903614458, 0.5052033106435321, 0.0, 0.4075257174776195], [0.3269689737470167, 0.5572548415111933, 0.04295942720763723, 0.1958273044273746], [0.2785714285714286, 0.5723887743992507, 0.0, 0.39380405301205185], [0.2458233890214797, 0.5787033017214711, 0.6085918854415274, 0.23844869415893283], [0.22142857142857142, 0.5918227303965115, 0.3738095238095238, 0.13566755991821805], [0.44761904761904764, 0.5053918568178541, 0.35714285714285715, 0.13727889840004145], [0.5107398568019093, 0.49164839993318554, 0.5799522673031027, 0.19430611504879783], [0.23809523809523808, 0.38166144286560444, 0.002380952380952381, 0.13560017743385927], [0.20047732696897375, 0.47462900059718727, 0.0, 0.21179687614223672], [0.16945107398568018, 0.6243915327621307, 0.0, 0.3403977718394287], [0.5119047619047619, 0.511007046286384, 0.0, 0.25850883289330145], [0.12171837708830549, 0.6502980761593863, 0.0, 0.46936063151326], [0.06666666666666667, 0.7287516189853939, 0.44761904761904764, 0.12949676290722306], [0.05476190476190476, 0.7057402271796638, 0.3238095238095238, 0.16026619689420815], [0.18377088305489261, 0.623625803865058, 0.0, 0.26752968939830357], [0.18795180722891566, 0.5849015094026868, 0.0, 0.28675250023406107], 
[0.15274463007159905, 0.6444592522616281, 0.016706443914081145, 0.07457922432911998], [0.10238095238095238, 0.6609591097936256, 0.0, 0.42561999058324346], [0.2523809523809524, 0.5769253066095862, 0.0, 0.40073999659429527], [0.18095238095238095, 0.6435603338282678, 0.0, 0.20461255371143977], [0.08333333333333333, 0.6157420199719073, 0.33095238095238094, 0.09692168281234893], [0.29285714285714287, 0.5679030621792486, 0.0, 0.4046704598260168], [0.2642857142857143, 0.6192572647550645, 0.0, 0.29458861932619246], [0.1738095238095238, 0.6231882156800725, 0.002380952380952381, 0.09547758687382164], [0.3333333333333333, 0.5561148907416799, 0.5095238095238095, 0.268773276930596], [0.44761904761904764, 0.48086983599947497, 0.37142857142857144, 0.06677337158596909], 
[0.569047619047619, 0.47291937955288305, 0.33095238095238094, 0.11885733231383518], [0.07380952380952381, 0.6923964411487729, 0.40714285714285714, 0.09032042004862009], [0.22142857142857142, 0.5990980263176197, 0.3595238095238095, 0.1868697175577109], [0.19664268585131894, 0.6531324379581097, 0.24700239808153476, 0.18168088884975764], [0.1761904761904762, 0.6452721913505973, 0.0, 0.28082512217310307], [0.20714285714285716, 0.640066006162071, 0.5357142857142857, 0.2843340719447215], [0.3904761904761905, 0.581590054558006, 0.0, 0.4660113070358066], [0.15714285714285714, 0.6387038946989015, 
0.5619047619047619, 0.2351758122228654], [0.4857142857142857, 0.4894145873377075, 0.0, 0.25895025805102667], [0.2261904761904762, 0.5665128684142131, 0.30714285714285716, 0.22206435072561653]]
""" 

